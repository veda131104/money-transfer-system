<section class="login-shell">
  <div class="ambient-orbit"></div>
  <div class="login-grid">
    <div class="login-panel">
      <div class="brand">
        <span class="brand-mark">PF</span>
        <div>
          <p class="brand-name">PayFid</p>
          <p class="brand-tag">Trusted rails for modern payouts</p>
        </div>
      </div>

      <mat-card class="card">
        <header class="card-header">
          <h1>Sign in to PayFid</h1>
        </header>

        <form class="form" [formGroup]="form" (ngSubmit)="submit()">
          <mat-form-field appearance="outline" class="field">
            <mat-label>Username</mat-label>
            <input matInput type="text" placeholder="Enter your username" autocomplete="username"
              formControlName="name" />
            @if (form.get('name')?.hasError('required')) {
            <mat-error>Username is required</mat-error>
            }
          </mat-form-field>

          <mat-form-field appearance="outline" class="field">
            <mat-label>Password</mat-label>
            <input matInput type="password" placeholder="Enter your password" autocomplete="current-password"
              formControlName="password" />
            @if (form.get('password')?.hasError('required')) {
            <mat-error>Password is required</mat-error>
            }
          </mat-form-field>

          <div class="form-row">
            <label class="checkbox">
              <input type="checkbox" formControlName="rememberMe" />
              <span>Keep me signed in</span>
            </label>
            <button class="link" type="button" mat-button (click)="openForgotModal()">Forgot password?</button>
          </div>

          <button class="primary" type="submit" mat-flat-button>Sign in</button>
        </form>

        <p class="footnote">
          New to PayFid?
          <a class="link" mat-button routerLink="/signup">Create an account</a>
        </p>
      </mat-card>
    </div>
  </div>

  @if (isForgotModalOpen) {
  <div class="modal-overlay">
    <div class="modal-card">
      <header class="modal-header">
        <h2>Password Recovery</h2>
        <p>Enter your username and we'll send a recovery email to your registered address.</p>
      </header>

      <mat-form-field appearance="outline" class="field">
        <mat-label>Username</mat-label>
        <input matInput type="text" placeholder="Your username" [(ngModel)]="forgotUsernameValue" [disabled]="isSending"
          (keyup.enter)="onForgotPassword()" />
      </mat-form-field>

      <div class="modal-actions">
        <button class="primary" (click)="onForgotPassword()" [disabled]="isSending">
          {{ isSending ? 'Sending...' : 'Send Recovery Email' }}
        </button>
        <button class="ghost" (click)="closeForgotModal()" [disabled]="isSending">Cancel</button>
      </div>
    </div>
  </div>
  }
</section>